<div class='head'>
	$lang.get('title.welcome') <b>$!me.nickname</b>
	<span class='right'>
		#if($me.hasAccess('access.config.admin'))
		<a href='javascript:;' class='btn btn-danger' onclick="_showrestart()">$lang.get('a.restart')</a>
		#end
	</span></div>

#if($me.hasAccess('access.config.admin'))
<div class='chart'>
	<iframe class='cpu_gauge' src="/admin/gauge/tps"></iframe>
	<iframe class='mem_gauge' src="/admin/gauge/mem"></iframe>
	<iframe class='disk_usage' src="/admin/gauge/disk"></iframe>
</div>
#end

<div class='state' style='display:block;'>
	<div class='login'>$lang.get('label.node'):<i>$!node</i></div>
	<div class='login'>$lang.get('cpu.num'):<i>$!cpus</i></div>
	<div class='login'>$lang.get('total.memory'):<i>$!totalmemory</i></div>
	<div class='login'>$lang.get('memory.total'):<i>$!total</i>, $lang.get('memory.free'):<i>$!free</i></div>
	<div class='login'>$lang.get('disk.speed'):
		 #if($diskspeed>200) <i style='color:green'>${diskspeed}(M/s)</i>
		 #elseif ($diskspeed>0) <i style='color:red'>${diskspeed}(M/s)</i>
		 #else
		 <i>...</i>
		 #end
	</div>
	<div class='uptime'>$lang.get('label.uptime'):<i>$uptime</i>, $lang.get('label.past'):<i>$past</i></div>
	<div class='release'>$lang.get('label.release'):<i>$!release</i></div>
	<div class='build'>$lang.get('label.build'):<i>$!build</i></div>
	<div class='build'>$lang.get('label.now'):<i>$!now</i></div>
	
</div>

<div id='restart' title="$lang.get('title.restart.service')" style="display:none">
	<div><label><h3>$lang.get('user.password'):</h3><input type='password' name='password'/></label></div>
	<button onclick='_restart();'>$lang.get('btn.ok')</button>
</div>

<script>
var _timer = false;
function _showrestart(){
	$('#restart').dialog({modal : true,close:function(e,ui){$(this).dialog('destroy');}});
}
function _restart(){
	
	processing && processing.show();
	$.post('/admin/system/restart', {pwd:$('#restart input[name=password]').val()}, function(d){
		if(d.state == 'ok') {
			$('#restart').dialog('close');
			_timer = setInterval(_load, 5000);
		} else {
			processing && processing.hide();
			$.error(d.message);
		}
	})
}

function _load() {
	$.get('/admin/dashboard', {}, function(d){
		window.location.href = window.location.href;
	});
}
</script>
