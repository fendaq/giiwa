<div class='head'>
	$lang.get('title.welcome') <b>$!me.nickname</b> <span class='right'>
		#if($me.hasAccess('access.config.admin',
		'access.config.restart.host')) <a href='javascript:;'
		class='btn btn-danger' onclick="_showrestart()">$lang.get('a.restart')</a>
		#end
	</span>
</div>

#if($porlets && $porlets.size()>0)
	#foreach($p in $porlets)
	<div class="porlet" data-uri="$p.uri" style="$!p.style"></div>
	#end
#else
	<div class='porlet'>
		<a class="btn btn-primary" href='/admin/profile/get/myporlet'>$lang.get('a.profile.myporlet')</a>
	</div>
#end

<div id='restart' title="$lang.get('title.restart.service')"
	style="display: none">
	<div>
		<label><h3>$lang.get('user.password'):</h3>
			<input type='password' name='password' /></label>
	</div>
	<div class='btns' style="text-align: center;margin-bottom:0">
		<button onclick='_restart();'>$lang.get('btn.ok')</button>
	</div>
</div>

<script>
var _timer = false;
function _showrestart(){
	giiwa.dialog($('#restart'), {width: 280, height:80});
}
function _restart(){
	
	giiwa.processing.show();
	$.post('/admin/system/restart', {pwd:$('#restart input[name=password]').val()}, function(d){
		if(d.state == 'ok') {
			giiwa.dialog().close();
			_timer = setInterval(_load, 5000);
		} else {
			giiwa.processing.hide();
			giiwa.error(d.message);
		}
	})
}

function _load() {
	$.get('/admin/dashboard', {}, function(d){
		window.location.href = window.location.href;
	});
}
</script>
